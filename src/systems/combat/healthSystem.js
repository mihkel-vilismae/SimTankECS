export function healthSystem(dt, world, registry){ const q=world.damageQueue||[]; world.damageQueue=[]; for(const evt of q){ if(!evt||typeof evt.entityId!=="number"||typeof evt.amount!=="number") continue; const e=registry.getById?.(evt.entityId); if(!e) continue; const h=registry.getComponent(e,"Health"); if(!h) continue; h.hp=Math.max(0,h.hp-Math.max(0,evt.amount)); if(h.hp<=0){ if(e.object3D&&e.object3D.parent) e.object3D.parent.remove(e.object3D); registry.remove(e.id); } } }
